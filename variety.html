<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRAVITY ç¶œè—æ´»å‹•</title>
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* 1. ç¢ºä¿èƒŒæ™¯ä¸æ–·å±¤ä¸”å›ºå®š */
        body {
            background-attachment: fixed !important;
            background-size: cover !important;
            margin: 0;
            padding: 0;
        }

        /* 2. å…§å®¹é–“è· (é¿å…è¢«å°è¦½åˆ—é®ä½) */
        .variety-page-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 20px 50px 20px;
        }

        /* 3. æœå°‹æ¡† (é…åˆæ‰“æ­Œèˆå°æ¨£å¼) */
        .search-wrapper {
            text-align: center;
            margin-bottom: 40px;
        }
        .search-bar {
            padding: 12px 25px;
            width: 90%;
            max-width: 500px;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.2);
            color: white;
            outline: none;
            backdrop-filter: blur(5px);
        }

        /* 4. åˆ†é¡æ¨™é¡Œ (é›»å°/ç¶œè—/æ¡è¨ª) */
        .category-group { margin-bottom: 50px; }
        .category-header {
            font-size: 24px;
            color: #fff;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
            margin-bottom: 25px;
            font-weight: bold;
        }

        /* 5. å¡ç‰‡æ¨£å¼ (å®Œå…¨å°é½Šæ‰“æ­Œèˆå°ï¼šæ·ºè‰²ã€ç™½å­—/ç°å­—) */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .variety-card {
            background: #fff; /* è·Ÿæ‰“æ­Œèˆå°ä¸€æ¨£çš„ç™½è‰²åŸºåº• */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: 0.3s;
            display: flex;
            flex-direction: column;
        }

        .variety-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(255,0,0,0.3); /* æ»‘éå¸¶ä¸€é» CRAVITY ç´…è‰²é™°å½± */
        }

        .card-img {
            width: 100%;
            height: 160px;
            object-fit: cover;
            background: #eee;
        }

        .card-body {
            padding: 15px;
            color: #333; /* æ–‡å­—æ”¹ç‚ºæ·±è‰²ï¼Œé…åˆç™½è‰²å¡ç‰‡ */
        }

        .v-sub { font-size: 12px; color: #ff0000; font-weight: bold; margin-bottom: 5px; }
        .v-title { font-size: 16px; font-weight: 800; margin-bottom: 10px; color: #000; line-height: 1.3; }
        .v-text { font-size: 13px; color: #666; margin-bottom: 3px; }
        
        .watch-link {
            display: block;
            text-align: center;
            background: #ff0000;
            color: #fff;
            text-decoration: none;
            padding: 8px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 14px;
            font-weight: bold;
        }
        .watch-link:hover { background: #333; }

    </style>
</head>
<body>

    <nav>
        <div class="logo">CRAVITY ç¶œè—æ´»å‹•</div>
        <ul>
            <li><a href="index.html">åœ˜é«”ä»‹ç´¹</a></li>
            <li><a href="members.html">æˆå“¡ä»‹ç´¹</a></li>
            <li><a href="discography.html">æ‰“æ­Œæ´»å‹•</a></li>
            <li><a href="variety.html">ç¶œè—æ´»å‹•</a></li>
        </ul>
    </nav>

    <div class="variety-page-container">
        <div class="search-wrapper">
            <input type="text" id="varietySearch" class="search-bar" placeholder="æœå°‹é—œéµå­—..." onkeyup="renderData()">
        </div>

        <div id="varietyDisplay"></div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxoOChbgdxhQb-iAwLewfnQgt8kdcBf_lww5VtlHzJxK1_Wuuzz6IxUxvtnAihK-nBD/exec"; 
        let allVarietyData = [];

        async function loadData() {
            try {
                const response = await fetch(`${SCRIPT_URL}?type=variety`);
                allVarietyData = await response.json();
                renderData();
            } catch (e) {
                document.getElementById('varietyDisplay').innerHTML = "<p style='color:white;'>è®€å–ä¸­æˆ–é€£ç·šå¤±æ•—...</p>";
            }
        }

        function renderData() {
            const keyword = document.getElementById('varietySearch').value.toLowerCase();
            const container = document.getElementById('varietyDisplay');
            const categories = ["é›»å°", "ç¶œè—", "æ¡è¨ª"];
            
            let html = "";

            categories.forEach(cat => {
                const filtered = allVarietyData.filter(item => 
                    item.mainCategory === cat && 
                    (item.title.toLowerCase().includes(keyword) || item.cast.toLowerCase().includes(keyword))
                );

                if (filtered.length > 0) {
                    html += `
                        <div class="category-group">
                            <h2 class="category-header">${cat}</h2>
                            <div class="card-grid">
                                ${filtered.map(item => `
                                    <div class="variety-card">
                                        <img src="images/${item.imageUrl}" class="card-img" 
                                            onerror="this.src='images/none.jpg'">
                                        <div class="card-body">
                                            <div class="v-sub">${item.subTitle}</div>
                                            <div class="v-title">${item.title}</div>
                                            <div class="v-text">ğŸ“… ${item.date ? item.date.split('T')[0] : ''}</div>
                                            <div class="v-text">ğŸ‘¥ ${item.cast}</div>
                                            <a href="${item.link}" target="_blank" class="watch-link">ç«‹å³è§€çœ‹</a>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html || "<p style='color:white;text-align:center;'>æ‰¾ä¸åˆ°çµæœ</p>";
        }

        window.onload = loadData;
    </script>
</body>
</html>
