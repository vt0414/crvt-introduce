<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRAVITY ç¶œè—æ´»å‹•</title>
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* --- ç¢ºä¿èƒŒæ™¯ä¸æ–·å±¤ --- */
        body {
            background-attachment: fixed !important;
            background-size: cover !important;
            margin: 0;
            padding: 0;
        }

        /* --- ä¿®æ­£å…§å®¹ä¸è¢«å°è¦½åˆ—é®æ“‹ (å‡è¨­å°è¦½åˆ—é«˜ç´„ 60-80px) --- */
        .main-content {
            padding-top: 100px; 
            max-width: 1200px;
            margin: 0 auto;
            padding-left: 20px;
            padding-right: 20px;
        }

        /* --- æœå°‹æ¬„æ¨£å¼ --- */
        .search-container {
            text-align: center;
            margin-bottom: 40px;
        }
        #varietySearch {
            width: 100%;
            max-width: 500px;
            padding: 12px 25px;
            border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            backdrop-filter: blur(10px);
            font-size: 16px;
            outline: none;
        }

        /* --- åˆ†é¡å€å¡Šæ¨£å¼ --- */
        .category-group { margin-bottom: 60px; }
        .group-title {
            font-size: 28px;
            color: #ff0000; /* CRAVITY ä»£è¡¨è‰² */
            border-left: 5px solid #ff0000;
            padding-left: 15px;
            margin-bottom: 25px;
        }

        /* --- å¡ç‰‡ç¶²æ ¼ç³»çµ± --- */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .variety-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            transition: transform 0.3s;
        }
        .variety-card:hover { transform: translateY(-10px); background: rgba(255,255,255,0.1); }

        .card-img { width: 100%; height: 180px; object-fit: cover; }
        .card-body { padding: 20px; }
        .v-subtitle { color: #00d2ff; font-size: 13px; font-weight: bold; }
        .v-title { font-size: 18px; margin: 8px 0; color: #fff; line-height: 1.4; }
        .v-info { font-size: 14px; color: #bbb; margin-bottom: 5px; }
        .v-note { font-size: 12px; color: #888; font-style: italic; margin-top: 10px; }

        .watch-btn {
            display: block;
            text-align: center;
            background: #ff0000;
            color: white;
            text-decoration: none;
            padding: 10px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: bold;
            transition: 0.3s;
        }
        .watch-btn:hover { background: #fff; color: #000; }
    </style>
</head>
<body>

    <nav>
        <div class="logo">CRAVITY ç¶œè—æ´»å‹•</div>
        <ul>
            <li><a href="index.html">åœ˜é«”ä»‹ç´¹</a></li>
            <li><a href="members.html">æˆå“¡ä»‹ç´¹</a></li>
            <li><a href="discography.html">æ‰“æ­Œæ´»å‹•</a></li>
            <li><a href="variety.html">ç¶œè—æ´»å‹•</a></li>
        </ul>
    </nav>

    <div class="main-content">
        <div class="search-container">
            <input type="text" id="varietySearch" placeholder="æœå°‹ç¯€ç›®ã€æ¨™é¡Œæˆ–æˆå“¡..." onkeyup="renderVariety()">
        </div>

        <div id="varietyDisplay">
            <p style="text-align: center; color: #888;">æ­£åœ¨åŠ è¼‰ç¶œè—æ´»å‹•è³‡æ–™...</p>
        </div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxoOChbgdxhQb-iAwLewfnQgt8kdcBf_lww5VtlHzJxK1_Wuuzz6IxUxvtnAihK-nBD/exec"; 

        async function fetchVariety() {
            try {
                const response = await fetch(`${SCRIPT_URL}?type=variety`);
                varietyData = await response.json();
                renderVariety();
            } catch (error) {
                document.getElementById('varietyDisplay').innerHTML = "<p style='text-align:center;'>è³‡æ–™è®€å–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥</p>";
            }
        }

        function renderVariety() {
            const searchTerm = document.getElementById('varietySearch').value.toLowerCase();
            const displayArea = document.getElementById('varietyDisplay');
            
            // æ ¹æ“šæœå°‹å­—è©ç¯©é¸
            const filtered = varietyData.filter(item => 
                item.title.toLowerCase().includes(searchTerm) || 
                item.subTitle.toLowerCase().includes(searchTerm) || 
                item.cast.toLowerCase().includes(searchTerm)
            );

            // åˆ†é¡é‚è¼¯ (å°æ‡‰ä½ çš„ Sheets: mainCategory)
            const categories = ["é›»å°", "ç¶œè—", "æ¡è¨ª"];
            let html = "";

            categories.forEach(cat => {
                const items = filtered.filter(i => i.mainCategory === cat);
                if (items.length > 0) {
                    html += `
                        <section class="category-group">
                            <h2 class="group-title">${cat}</h2>
                            <div class="card-grid">
                                ${items.map(item => `
                                    <div class="variety-card">
                                        <img src="${item.imageUrl || 'https://via.placeholder.com/400x225?text=CRAVITY'}" class="card-img" alt="cover">
                                        <div class="card-body">
                                            <div class="v-subtitle">${item.subTitle}</div>
                                            <div class="v-title">${item.title}</div>
                                            <div class="v-info">ğŸ“… æ—¥æœŸï¼š${item.date ? item.date.split('T')[0] : 'TBA'}</div>
                                            <div class="v-info">ğŸ‘¥ æˆå“¡ï¼š${item.cast}</div>
                                            ${item.note ? `<div class="v-note">è¨»ï¼š${item.note}</div>` : ''}
                                            <a href="${item.link}" target="_blank" class="watch-btn">ç«‹å³è§€çœ‹</a>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </section>
                    `;
                }
            });

            displayArea.innerHTML = html || "<p style='text-align:center;'>æ‰¾ä¸åˆ°ç¬¦åˆçš„é …ç›®</p>";
        }

        window.onload = fetchVariety;
    </script>
</body>
</html>
